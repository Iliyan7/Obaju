@model List<CategoriesWithProductsCountViewModel>
@{
    var menCategories = Model.Where(c => c.Gender == Gender.Men);
    var ladiesCategories = Model.Where(c => c.Gender == Gender.Ladies);
}

<div class="panel panel-default sidebar-menu">
    <div class="panel-heading">
        <h3 class="panel-title">Categories</h3>
    </div>

    <div class="panel-body">
        <ul class="nav nav-pills nav-stacked category-menu">
            <li @if ((string)ViewBag.CategoryGender == Gender.Men) { @: class="active"
                }>
                <a asp-action="Categories" asp-route-categoryGender="@Gender.Men">Men <span class="badge pull-right">@menCategories.Sum(c => c.ProductsCount)</span></a>
                <ul>
                    @foreach (var category in menCategories)
                    {
                        <li><a asp-action="Categories" asp-route-categoryName="@category.Name" asp-route-categoryGender="@category.Gender">@category.Name</a></li>
                    }
                </ul>
            </li>
            <li @if (ViewBag.CategoryGender == Gender.Ladies) { @: class="active"
                }>
                <a asp-action="Categories" asp-route-categoryGender="@Gender.Ladies">Ladies <span class="badge pull-right">@ladiesCategories.Sum(c => c.ProductsCount)</span></a>
                <ul>
                    @foreach (var category in ladiesCategories)
                    {
                        <li><a asp-action="Categories" asp-route-categoryName="@category.Name" asp-route-categoryGender="@category.Gender">@category.Name</a></li>
                    }
                </ul>
            </li>
        </ul>
    </div>
</div>